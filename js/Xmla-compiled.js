(function(z){function S(a){var c,d=!1,f=function(){d=!0;switch(e.readyState){case 0:x(a.aborted)&&a.aborted(e);break;case 4:if(200<=e.status&&299>=e.status)a.complete(e);else{var c=b.Exception._newError("HTTP_ERROR","_ajax",{request:a,status:this.status,statusText:this.statusText,xhr:e});a.error(c)}}};var e=C();var g=["POST",a.url,a.async];a.username&&a.password&&(g=g.concat([a.username,a.password]));e.open.apply(e,g);e.withCredentials=!0;m(a.requestTimeout)||!a.async&&z&&z.document||(e.timeout=a.requestTimeout);
e.onreadystatechange=f;e.setRequestHeader("Accept","text/xml, application/xml, application/soap+xml");e.setRequestHeader("Content-Type","text/xml");if(g=a.headers)for(c in g)e.setRequestHeader(c,g[c]);e.send(a.data);a.async||d||f.call(e);return e}function m(a){return"undefined"===typeof a}function u(a){return a&&a.constructor===Array}function x(a){return"function"===typeof a}function F(a){switch(typeof a){case "string":a=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");break;case "undefined":a=
"";break;case "object":null===a&&(a="")}return a}function L(a){return a.replace(/_x(\d\d\d\d)_/g,function(a,b,f){return String.fromCharCode(parseInt(b,16))})}function G(a,b,d){a=a.childNodes;if(!a)return b;for(var c,e=0,g=a.length;e<g;e++)c=a[e],d&&!0===d.call(null,c)&&b.push(c),G(c,b,d)}function v(a){var b;v=b="textContent"in a?function(a){return a.textContent}:"nodeTypedValue"in a?function(a){return a.nodeTypedValue}:"innerText"in a?function(a){return a.innerText}:"normalize"in a?function(a){a.normalize();
return a.firstChild?a.firstChild.data:null}:function(a){var b=[],c=a.childNodes,d,l=c?c.length:0;for(d=0;d<l;d++)a=c[d],null!==a.data&&b.push(a.data);return b.length?b.join(""):null};return b(a)}function H(a,b,d,f){f||(f="");var c,g,l="\n"+f+"<"+a+">";if(d){l+="\n"+f+" <"+b+">";for(g in d)if(d.hasOwnProperty(g)){var n=d[g];l+="\n"+f+"  <"+g+">";if(u(n)){var w=n.length;for(c=0;c<w;c++){var h=n[c];l+="<Value>"+F(h)+"</Value>"}}else l+=F(n);l+="</"+g+">"}l+="\n"+f+" </"+b+">"}return l+("\n"+f+"</"+a+
">")}function h(a,b,d){b&&!a&&(a={});for(var c in b)b.hasOwnProperty(c)&&(d||m(a[c]))&&(a[c]=b[c]);return a}function I(a){function b(){p.push(w);var a=new function(){};a.constructor.prototype=w;w=new a.constructor;k.namespaces=w;t=!0}function d(a){return a.replace(/&((\w+)|#(x?)([0-9a-fA-F]+));/g,function(a,b,c,d,f,e,g){if(c){if(a={lt:"<",gt:">",amp:"&",apos:"'",quot:'"'}[c])return a;throw"Illegal named entity: "+c;}return String.fromCharCode(parseInt(f,d?16:10))})}var f=/<(((([\w\-\.]+):)?([\w\-\.]+))([^>]+)?|\/((([\w\-\.]+):)?([\w\-\.]+))|\?(\w+)([^\?]+)?\?|(!--([^\-]|-[^\-])*--))>|([^<>]+)/ig,
e,g,l,n,w={"":""},h,r,p=[],k=null;for(h=r={nodeType:9,childNodes:[]};e=f.exec(a);){k=null;if(g=e[5]){var t=!1;var q=k={offset:e.index,parentNode:r,nodeType:1,nodeName:g};if(g=e[6]){g.length&&"/"===g.substr(g.length-1,1)&&(q=k.parentNode,w===k.namespaces&&(w=p.pop()),g=g.substr(0,g.length-1));for(var y,v=/((([\w\-]+):)?([\w\-]+))\s*=\s*('([^']*)'|"([^"]*)")/g;y=v.exec(g);){var u=y[3]||"";var z=y[y[6]?6:7];if(y[1].indexOf("xmlns")){k.attributes||(k.attributes=[]);y={nodeType:2,prefix:u,nodeName:y[4],
value:d(z)};u=""===u?"":w[u];if(m(u))throw'Unrecognized namespace with prefix "'+x+'"';y.namespaceURI=u;k.attributes.push(y)}else t||b(),w[y[3]?y[4]:""]=z}v.lastIndex=0}var x=e[4]||"";k.prefix=x;u=w[x];if(m(u))throw'Unrecognized namespace with prefix "'+x+'"';k.namespaceURI=u}else if(g=e[10])if(e=e[9]||"",r.nodeName===g&&r.prefix===e)q=r.parentNode,w===r.namespaces&&(w=p.pop());else throw"Unclosed tag "+e+":"+g;else(l=e[11])?k={offset:e.index,parentNode:r,target:l,data:e[12],nodeType:7}:e[13]?k={offset:e.index,
parentNode:r,nodeType:8,data:e[14]}:(n=e[15])&&!/^\s+$/.test(n)&&(k={offset:e.index,parentNode:r,nodeType:3,data:d(n)});k&&(r.childNodes||(r.childNodes=[]),r.childNodes.push(k));q&&(r=q)}return h}function J(a,b){a=k(a,"http://www.w3.org/2001/XMLSchema","xsd","complexType");var c=a.length,f;for(f=0;f<c;f++){var e=a[f];if(t(e,"name")===b)return e}return null}function M(a){return"true"===a?!0:!1}function q(a){return parseInt(a,10)}function D(a){return parseFloat(a,10)}function E(a){return a}function N(a){return Date.parse(a)}
function O(a){return a}function K(a,b){var c=[],f=a.length,e;for(e=0;e<f;e++){var g=a[e];c.push(b(v(g)))}return c}function P(a){var b;return(b=A[a])?b:E}function Q(a){var b=v(a);if(a=B(a,"http://www.w3.org/2001/XMLSchema-instance","xsi","type"))if(a=A[a])return a(b);return b}function T(a){return"get"+(/^[A-Z]+[a-z]+[A-Za-z]*$/g.test(a)?a:a.charAt(0).toUpperCase()+a.substr(1).toLowerCase().replace(/_[a-z]/g,function(a){return a.charAt(1).toUpperCase()}))}var C;z.XMLHttpRequest?C=function(){return new z.XMLHttpRequest}:
z.ActiveXObject?C=function(){return new z.ActiveXObject("MSXML2.XMLHTTP.3.0")}:"function"===typeof require?C=function(){var a;(a=function(){this.readyState=0;this.status=-1;this.statusText="Not sent";this.responseText=null}).prototype={changeStatus:function(a,b){this.statusText=this.status=a;this.readyState=b;x(this.onreadystatechange)&&this.onreadystatechange.call(this,this)},open:function(a,b,f,e,g){if(!0!==f)throw"Synchronous mode not supported in this environment.";a=require("url").parse(b);a.host.length>
a.hostname.length&&(a.host=a.hostname,delete a.hostname);!a.path&&a.pathname&&(a.path=a.pathname+(a.search||""));a.method="POST";a.headers={};e&&(a.headers.Authorization="Basic "+(new Buffer(e+":"+(g||""))).toString("base64"));this.options=a;this.changeStatus(-1,1)},send:function(a){var b=this,c=b.options;c.headers["Content-Length"]=Buffer.byteLength(a);switch(c.protocol){case "http:":var e=require("http");c.port||(c.port="80");break;case "https:":e=require("https");c.port||(c.port="443");break;default:throw"Unsupported protocol "+
c.protocol;}b.responseText="";c=e.request(c,function(a){a.setEncoding("utf8");b.changeStatus(-1,2);a.on("data",function(c){b.responseText+=c;b.changeStatus(a.statusCode,3)});a.on("error",function(c){b.changeStatus(a.statusCode,4)});a.on("end",function(){b.changeStatus(a.statusCode,4)})});c.on("error",function(a){b.responseText=a;b.changeStatus(500,4)});a&&c.write(a);c.end()},setRequestHeader:function(a,b){this.options.headers[a]=b}};return new a}:b.Exception._newError("ERROR_INSTANTIATING_XMLHTTPREQUEST",
"_ajax",null)._throw();var R=function(a,b){if("getElementsByTagName"in a)var c=function(a,b){return a.getElementsByTagName(b)};else{var f=function(a){if(1!==a.nodeType)return!1;(a=""===a.namespaceURI?"":a.prefix)&&(a+=":");return a+b===b};c=function(a,b){var c=[];G(a,c,"*"===b?null:f);return c}}return(R=c)(a,b)},k=function(a,b,d,f){var c;k=c="getElementsByTagNameNS"in a?function(a,b,c,d){return a.getElementsByTagNameNS(b,d)}:"getElementsByTagName"in a?function(a,b,c,d){return a.getElementsByTagName((c?
c+":":"")+d)}:function(a,b,c,d){c=[];G(a,c,"*"===d?function(a){return 1===a.nodeType&&a.namespaceURI===b}:function(a){return 1===a.nodeType&&a.namespaceURI===b&&a.nodeName===d});return c};return c(a,b,d,f)},B=function(a,b,d,f){return(B="getAttributeNS"in a?function(a,b,c,d){return a.getAttributeNS(b,d)}:"getAttribute"in a?function(a,b,c,d){return a.getAttribute((c?c+":":"")+d)}:function(a,b,c,d){a=a.attributes;if(!a)return null;for(var f=0,e=a.length;f<e;f++)if(c=a[f],c.namespaceURI===b&&c.nodeName===
d)return c.value;return null})(a,b,d,f)},t=function(a,b){return(t="getAttribute"in a?function(a,b){return a.getAttribute(b)}:function(a,b){a=a.attributes;if(!a)return null;for(var c,d=0,f=a.length;d<f;d++)if(c=a[d],c.nodeName===b)return c.value;return null})(a,b)};var b=function(a){this.listeners={};this.listeners[b.EVENT_REQUEST]=[];this.listeners[b.EVENT_SUCCESS]=[];this.listeners[b.EVENT_ERROR]=[];this.listeners[b.EVENT_DISCOVER]=[];this.listeners[b.EVENT_DISCOVER_SUCCESS]=[];this.listeners[b.EVENT_DISCOVER_ERROR]=
[];this.listeners[b.EVENT_EXECUTE]=[];this.listeners[b.EVENT_EXECUTE_SUCCESS]=[];this.listeners[b.EVENT_EXECUTE_ERROR]=[];this.options=h(h({},b.defaultOptions,!0),a,!0);(a=this.options.listeners)&&this.addListener(a);return this};b.defaultOptions={requestTimeout:3E4,async:!1,addFieldGetters:!0,forceResponseXMLEmulation:!1};b.METHOD_DISCOVER="Discover";b.METHOD_EXECUTE="Execute";b.DISCOVER_DATASOURCES="DISCOVER_DATASOURCES";b.DISCOVER_PROPERTIES="DISCOVER_PROPERTIES";b.DISCOVER_SCHEMA_ROWSETS="DISCOVER_SCHEMA_ROWSETS";
b.DISCOVER_ENUMERATORS="DISCOVER_ENUMERATORS";b.DISCOVER_KEYWORDS="DISCOVER_KEYWORDS";b.DISCOVER_LITERALS="DISCOVER_LITERALS";b.DBSCHEMA_CATALOGS="DBSCHEMA_CATALOGS";b.DBSCHEMA_COLUMNS="DBSCHEMA_COLUMNS";b.DBSCHEMA_PROVIDER_TYPES="DBSCHEMA_PROVIDER_TYPES";b.DBSCHEMA_SCHEMATA="DBSCHEMA_SCHEMATA";b.DBSCHEMA_TABLES="DBSCHEMA_TABLES";b.DBSCHEMA_TABLES_INFO="DBSCHEMA_TABLES_INFO";b.MDSCHEMA_ACTIONS="MDSCHEMA_ACTIONS";b.MDSCHEMA_CUBES="MDSCHEMA_CUBES";b.MDSCHEMA_DIMENSIONS="MDSCHEMA_DIMENSIONS";b.MDSCHEMA_FUNCTIONS=
"MDSCHEMA_FUNCTIONS";b.MDSCHEMA_HIERARCHIES="MDSCHEMA_HIERARCHIES";b.MDSCHEMA_LEVELS="MDSCHEMA_LEVELS";b.MDSCHEMA_MEASURES="MDSCHEMA_MEASURES";b.MDSCHEMA_MEMBERS="MDSCHEMA_MEMBERS";b.MDSCHEMA_PROPERTIES="MDSCHEMA_PROPERTIES";b.MDSCHEMA_SETS="MDSCHEMA_SETS";b.EVENT_REQUEST="request";b.EVENT_SUCCESS="success";b.EVENT_ERROR="error";b.EVENT_EXECUTE="execute";b.EVENT_EXECUTE_SUCCESS="executesuccess";b.EVENT_EXECUTE_ERROR="executeerror";b.EVENT_DISCOVER="discover";b.EVENT_DISCOVER_SUCCESS="discoversuccess";
b.EVENT_DISCOVER_ERROR="discovererror";b.EVENT_GENERAL=[b.EVENT_REQUEST,b.EVENT_SUCCESS,b.EVENT_ERROR];b.EVENT_DISCOVER_ALL=[b.EVENT_DISCOVER,b.EVENT_DISCOVER_SUCCESS,b.EVENT_DISCOVER_ERROR];b.EVENT_EXECUTE_ALL=[b.EVENT_EXECUTE,b.EVENT_EXECUTE_SUCCESS,b.EVENT_EXECUTE_ERROR];b.EVENT_ALL=[].concat(b.EVENT_GENERAL,b.EVENT_DISCOVER_ALL,b.EVENT_EXECUTE_ALL);b.PROP_DATASOURCEINFO="DataSourceInfo";b.PROP_CATALOG="Catalog";b.PROP_CUBE="Cube";b.PROP_FORMAT="Format";b.PROP_FORMAT_TABULAR="Tabular";b.PROP_FORMAT_MULTIDIMENSIONAL=
"Multidimensional";b.PROP_AXISFORMAT="AxisFormat";b.PROP_AXISFORMAT_TUPLE="TupleFormat";b.PROP_AXISFORMAT_CLUSTER="ClusterFormat";b.PROP_AXISFORMAT_CUSTOM="CustomFormat";b.PROP_CONTENT="Content";b.PROP_CONTENT_DATA="Data";b.PROP_CONTENT_NONE="None";b.PROP_CONTENT_SCHEMA="Schema";b.PROP_CONTENT_SCHEMADATA="SchemaData";b.prototype={listeners:null,soapMessage:null,response:null,responseText:null,responseXML:null,getResponseXML:function(){if(!0!==this.options.forceResponseXMLEmulation||this.responseText===
this._responseTextForResponseXML&&this.responseXML)return this.responseXML;this.responseXML=I(this.responseText);this._responseTextForResponseXML=this.responseText;return this.responseXML},setOptions:function(a){h(this.options,a,!0)},addListener:function(){var a=arguments.length,c;switch(a){case 0:b.Exception._newError("NO_EVENTS_SPECIFIED","Xmla.addListener",null)._throw();case 1:var d=arguments[0];if(d&&"object"===typeof d){var f;if(u(d))this._addListeners(d);else if(f=d.events||d.event)for("string"===
typeof f&&(f="all"===f?b.EVENT_ALL:f.split(",")),u(f)||b.Exception._newError("WRONG_EVENTS_FORMAT","Xmla.addListener",d)._throw(),a=f.length,c=0;c<a;c++)this._addListener(f[c],d);else for(f in a=d.scope,m(a)?a=null:delete d.scope,d)c=d[f],m(c.scope)&&(c.scope=a),this._addListener(f,c)}else b.Exception._newError("WRONG_EVENTS_FORMAT","Xmla.addListener",d)._throw();break;case 2:case 3:d=arguments[0];a=arguments[2];c=arguments[1];"string"===typeof d&&(x(c)||c&&"object"===typeof c)?this._addListener(d,
c,a):(d=[d,c],a&&d.push(a),this.addListener(d));break;default:this._addListeners(arguments)}},_addListeners:function(a){var b,d=a.length;for(b=0;b<d;b++)this.addListener(a[b])},_addListener:function(a,c,d){var f=this.listeners[a];f||b.Exception._newError("UNKNOWN_EVENT","Xmla.addListener",{event:a,handler:c,scope:d})._throw();d||(d=null);switch(typeof c){case "function":f.push({handler:c,scope:d});break;case "object":var e=c.handler||c.handlers;c.scope&&(d=c.scope);if(x(e))f.push({handler:e,scope:d});
else if(u(e))for(f=e.length,c=0;c<f;c++)this._addListener(a,e[c],d)}},_fireEvent:function(a,c,d){var f=this.listeners[a];f||b.Exception._newError("UNKNOWN_EVENT","Xmla._fireEvent",a)._throw();var e=f.length,g=!0;if(e){var l;for(l=0;l<e;l++){var n=f[l];n=n.handler.call(n.scope,a,c,this);if(d&&!1===n){g=!1;break}}}else a!==b.EVENT_ERROR||x(c.error)||x(c.callback)||c.exception._throw();return g},getXmlaSoapMessage:function(a){var c=a.method,d='<?xml version="1.0" encoding="UTF-8"?>\n<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">\n <SOAP-ENV:Body>\n  <'+
c+' xmlns="urn:schemas-microsoft-com:xml-analysis" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">';switch(c){case b.METHOD_DISCOVER:a.requestType||b.Exception._newError("MISSING_REQUEST_TYPE","Xmla._getXmlaSoapMessage",a)._throw();d+="\n   <RequestType>"+a.requestType+"</RequestType>"+H("Restrictions","RestrictionList",a.restrictions,"   ")+H("Properties","PropertyList",a.properties,"   ");break;case b.METHOD_EXECUTE:a.statement||b.Exception._newError("MISSING_REQUEST_TYPE","Xmla._getXmlaSoapMessage",
a)._throw(),d+="\n   <Command>\n    <Statement>"+F(a.statement)+"</Statement>\n   </Command>"+H("Properties","PropertyList",a.properties,"   ")}return d+("\n  </"+c+">\n </SOAP-ENV:Body>\n</SOAP-ENV:Envelope>")},request:function(a){var c=this;this.responseXML=this.responseText=this.response=null;a=h(a,this.options,!1);if(!a.url){var d=b.Exception._newError("MISSING_URL","Xmla.request",a);d._throw()}a.properties=h(a.properties,this.options.properties,!1);a.restrictions=h(a.restrictions,this.options.restrictions,
!1);delete a.exception;if(!this._fireEvent(b.EVENT_REQUEST,a,!0)||a.method==b.METHOD_DISCOVER&&!this._fireEvent(b.EVENT_DISCOVER,a)||a.method==b.METHOD_EXECUTE&&!this._fireEvent(b.EVENT_EXECUTE,a))return!1;this.soapMessage=d=this.getXmlaSoapMessage(a);d={async:a.async,timeout:a.requestTimeout,data:d,error:function(b){a.exception=b;c._requestError(a,b)},complete:function(b){a.xhr=b;c._requestSuccess(a)},url:a.url};a.username&&(d.username=a.username);a.password&&(d.password=a.password);var f={};this.options.headers&&
(f=h(f,this.options.headers));a.headers&&(f=h(f,a.headers,!0));d.headers=f;S(d);return this.response},_requestError:function(a,c){a.error&&a.error.call(a.scope?a.scope:null,this,a,c);a.callback&&a.callback.call(a.scope?a.scope:null,b.EVENT_ERROR,this,a,c);this._fireEvent(b.EVENT_ERROR,a)},_parseSoapFault:function(a){var b={},d,f=a.childNodes,e=f.length;for(d=0;d<e;d++){var g=f[d];if(1===g.nodeType){a=g.nodeName;switch(a){case "faultactor":case "faultstring":case "faultcode":var l=v(g);break;case "detail":var n;
l=[];var k=g.childNodes,h=k.length;for(n=0;n<h;n++)if(g=k[n],1===g.nodeType)switch(g.nodeName){case "Error":l.push({ErrorCode:t(g,"ErrorCode"),Description:t(g,"Description"),Source:t(g,"Source"),HelpFile:t(g,"HelpFile")})}break;default:l=null}l&&(b[a]=l)}}return b},_requestSuccess:function(a){var c=a.xhr,d;!0!==a.forceResponseXMLEmulation&&(this.responseXML=c.responseXML);this.responseText=c.responseText;c=a.method;try{var f=this.getResponseXML();f||(a.exception=new b.Exception(b.Exception.TYPE_ERROR,
b.Exception.ERROR_PARSING_RESPONSE_CDE,"Response is not an XML document."));var e=k(f,"http://schemas.xmlsoap.org/soap/envelope/","SOAP-ENV","Fault");if(e.length)e=e[0],e=this._parseSoapFault(e),a.exception=new b.Exception(b.Exception.TYPE_ERROR,e.faultcode,e.faultstring,null,"_requestSuccess",a,null,e.detail,e.faultactor);else{switch(c){case b.METHOD_DISCOVER:a.rowset=d=new b.Rowset(f,a.requestType,this);break;case b.METHOD_EXECUTE:var g=e=null;switch(a.properties[b.PROP_FORMAT]){case b.PROP_FORMAT_TABULAR:d=
e=new b.Rowset(f,null,this);break;case b.PROP_FORMAT_MULTIDIMENSIONAL:d=g=new b.Dataset(f)}a.resultset=e;a.dataset=g}this.response=d}}catch(l){a.exception=l}if(a.exception){switch(c){case b.METHOD_DISCOVER:this._fireEvent(b.EVENT_DISCOVER_ERROR,a);break;case b.METHOD_EXECUTE:this._fireEvent(b.EVENT_EXECUTE_ERROR,a)}a.error&&a.error.call(a.scope?a.scope:null,this,a,a.exception);a.callback&&a.callback.call(a.scope?a.scope:null,b.EVENT_ERROR,this,a,a.exception);this._fireEvent(b.EVENT_ERROR,a)}else{switch(c){case b.METHOD_DISCOVER:this._fireEvent(b.EVENT_DISCOVER_SUCCESS,
a);break;case b.METHOD_EXECUTE:this._fireEvent(b.EVENT_EXECUTE_SUCCESS,a)}a.success&&a.success.call(a.scope?a.scope:null,this,a,d);a.callback&&a.callback.call(a.scope?a.scope:null,b.EVENT_SUCCESS,this,a,d);this._fireEvent(b.EVENT_SUCCESS,a)}},execute:function(a){var c=a.properties;c||(c={},a.properties=c);h(c,this.options.properties,!1);c[b.PROP_CONTENT]||(c[b.PROP_CONTENT]=b.PROP_CONTENT_SCHEMADATA);c[b.PROP_FORMAT]||(a.properties[b.PROP_FORMAT]=b.PROP_FORMAT_MULTIDIMENSIONAL);a=h(a,{method:b.METHOD_EXECUTE},
!0);return this.request(a)},executeTabular:function(a){a.properties||(a.properties={});a.properties[b.PROP_FORMAT]=b.PROP_FORMAT_TABULAR;return this.execute(a)},executeMultiDimensional:function(a){a.properties||(a.properties={});a.properties[b.PROP_FORMAT]=b.PROP_FORMAT_MULTIDIMENSIONAL;return this.execute(a)},discover:function(a){a=h(a,{method:b.METHOD_DISCOVER},!0);a.requestType||(a.requestType=this.options.requestType);a.properties||(a.properties={});a.properties[b.PROP_FORMAT]=b.PROP_FORMAT_TABULAR;
return this.request(a)},discoverDataSources:function(a){a=h(a,{requestType:b.DISCOVER_DATASOURCES},!0);return this.discover(a)},discoverProperties:function(a){a=h(a,{requestType:b.DISCOVER_PROPERTIES},!0);return this.discover(a)},discoverSchemaRowsets:function(a){a=h(a,{requestType:b.DISCOVER_SCHEMA_ROWSETS},!0);return this.discover(a)},discoverEnumerators:function(a){a=h(a,{requestType:b.DISCOVER_ENUMERATORS},!0);return this.discover(a)},discoverKeywords:function(a){a=h(a,{requestType:b.DISCOVER_KEYWORDS},
!0);return this.discover(a)},discoverLiterals:function(a){a=h(a,{requestType:b.DISCOVER_LITERALS},!0);return this.discover(a)},discoverDBCatalogs:function(a){a=h(a,{requestType:b.DBSCHEMA_CATALOGS},!0);return this.discover(a)},discoverDBColumns:function(a){a=h(a,{requestType:b.DBSCHEMA_COLUMNS},!0);return this.discover(a)},discoverDBProviderTypes:function(a){a=h(a,{requestType:b.DBSCHEMA_PROVIDER_TYPES},!0);return this.discover(a)},discoverDBSchemata:function(a){a=h(a,{requestType:b.DBSCHEMA_SCHEMATA},
!0);return this.discover(a)},discoverDBTables:function(a){a=h(a,{requestType:b.DBSCHEMA_TABLES},!0);return this.discover(a)},discoverDBTablesInfo:function(a){a=h(a,{requestType:b.DBSCHEMA_TABLES_INFO},!0);return this.discover(a)},discoverMDActions:function(a){a=h(a,{requestType:b.MDSCHEMA_ACTIONS},!0);return this.discover(a)},discoverMDCubes:function(a){a=h(a,{requestType:b.MDSCHEMA_CUBES},!0);return this.discover(a)},discoverMDDimensions:function(a){a=h(a,{requestType:b.MDSCHEMA_DIMENSIONS},!0);
return this.discover(a)},discoverMDFunctions:function(a){a=h(a,{requestType:b.MDSCHEMA_FUNCTIONS},!0);return this.discover(a)},discoverMDHierarchies:function(a){a=h(a,{requestType:b.MDSCHEMA_HIERARCHIES},!0);return this.discover(a)},discoverMDLevels:function(a){a=h(a,{requestType:b.MDSCHEMA_LEVELS},!0);return this.discover(a)},discoverMDMeasures:function(a){a=h(a,{requestType:b.MDSCHEMA_MEASURES},!0);return this.discover(a)},discoverMDMembers:function(a){a=h(a,{requestType:b.MDSCHEMA_MEMBERS},!0);
return this.discover(a)},discoverMDProperties:function(a){a=h(a,{requestType:b.MDSCHEMA_PROPERTIES},!0);return this.discover(a)},discoverMDSets:function(a){a=h(a,{requestType:b.MDSCHEMA_SETS},!0);return this.discover(a)}};b.Rowset=function(a,b,d){"string"===typeof a&&(a=I(a));this._node=a;this._type=b;this._xmla=d;this._initData();return this};b.Rowset.MD_DIMTYPE_UNKNOWN=0;b.Rowset.MD_DIMTYPE_TIME=1;b.Rowset.MD_DIMTYPE_MEASURE=2;b.Rowset.MD_DIMTYPE_OTHER=3;b.Rowset.MD_DIMTYPE_QUANTITATIVE=5;b.Rowset.MD_DIMTYPE_ACCOUNTS=
6;b.Rowset.MD_DIMTYPE_CUSTOMERS=7;b.Rowset.MD_DIMTYPE_PRODUCTS=8;b.Rowset.MD_DIMTYPE_SCENARIO=9;b.Rowset.MD_DIMTYPE_UTILIY=10;b.Rowset.MD_DIMTYPE_CURRENCY=11;b.Rowset.MD_DIMTYPE_RATES=12;b.Rowset.MD_DIMTYPE_CHANNEL=13;b.Rowset.MD_DIMTYPE_PROMOTION=14;b.Rowset.MD_DIMTYPE_ORGANIZATION=15;b.Rowset.MD_DIMTYPE_BILL_OF_MATERIALS=16;b.Rowset.MD_DIMTYPE_GEOGRAPHY=17;b.Rowset.MD_STRUCTURE_FULLYBALANCED=0;b.Rowset.MD_STRUCTURE_RAGGEDBALANCED=1;b.Rowset.MD_STRUCTURE_UNBALANCED=2;b.Rowset.MD_STRUCTURE_NETWORK=
3;b.Rowset.MD_USER_DEFINED=1;b.Rowset.MD_SYSTEM_ENABLED=2;b.Rowset.MD_SYSTEM_INTERNAL=4;b.Rowset.MDMEMBER_TYPE_REGULAR=1;b.Rowset.MDMEMBER_TYPE_ALL=2;b.Rowset.MDMEMBER_TYPE_FORMULA=3;b.Rowset.MDMEMBER_TYPE_MEASURE=4;b.Rowset.MDMEMBER_TYPE_UNKNOWN=0;b.Rowset.MDMEASURE_AGGR_SUM=1;b.Rowset.MDMEASURE_AGGR_COUNT=2;b.Rowset.MDMEASURE_AGGR_MIN=3;b.Rowset.MDMEASURE_AGGR_MAX=4;b.Rowset.MDMEASURE_AGGR_AVG=5;b.Rowset.MDMEASURE_AGGR_VAR=6;b.Rowset.MDMEASURE_AGGR_STD=7;b.Rowset.MDMEASURE_AGGR_DST=8;b.Rowset.MDMEASURE_AGGR_NONE=
9;b.Rowset.MDMEASURE_AGGR_AVGCHILDREN=10;b.Rowset.MDMEASURE_AGGR_FIRSTCHILD=11;b.Rowset.MDMEASURE_AGGR_LASTCHILD=12;b.Rowset.MDMEASURE_AGGR_FIRSTNONEMPTY=13;b.Rowset.MDMEASURE_AGGR_LASTNONEMPTY=14;b.Rowset.MDMEASURE_AGGR_BYACCOUNT=15;b.Rowset.MDMEASURE_AGGR_CALCULATED=127;b.Rowset.MDMEASURE_AGGR_UNKNOWN=0;b.Rowset.MDPROP_MEMBER=1;b.Rowset.MDPROP_CELL=2;b.Rowset.MDPROP_SYSTEM=4;b.Rowset.MDPROP_BLOB=8;b.Rowset.KEYS={};b.Rowset.KEYS[b.DBSCHEMA_CATALOGS]=["CATALOG_NAME"];b.Rowset.KEYS[b.DBSCHEMA_COLUMNS]=
["TABLE_CATALOG","TABLE_SCHEMA","TABLE_NAME","COLUMN_NAME"];b.Rowset.KEYS[b.DBSCHEMA_PROVIDER_TYPES]=["TYPE_NAME"];b.Rowset.KEYS[b.DBSCHEMA_SCHEMATA]=["CATALOG_NAME","SCHEMA_NAME"];b.Rowset.KEYS[b.DBSCHEMA_TABLES]=["TABLE_CATALOG","TABLE_SCHEMA","TABLE_NAME"];b.Rowset.KEYS[b.DBSCHEMA_TABLES_INFO]=["TABLE_CATALOG","TABLE_SCHEMA","TABLE_NAME"];b.Rowset.KEYS[b.DISCOVER_DATASOURCES]=["DataSourceName"];b.Rowset.KEYS[b.DISCOVER_ENUMERATORS]=["EnumName","ElementName"];b.Rowset.KEYS[b.DISCOVER_KEYWORDS]=
["Keyword"];b.Rowset.KEYS[b.DISCOVER_LITERALS]=["LiteralName"];b.Rowset.KEYS[b.DISCOVER_PROPERTIES]=["PropertyName"];b.Rowset.KEYS[b.DISCOVER_SCHEMA_ROWSETS]=["SchemaName"];b.Rowset.KEYS[b.MDSCHEMA_ACTIONS]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","ACTION_NAME"];b.Rowset.KEYS[b.MDSCHEMA_CUBES]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME"];b.Rowset.KEYS[b.MDSCHEMA_DIMENSIONS]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","DIMENSION_UNIQUE_NAME"];b.Rowset.KEYS[b.MDSCHEMA_FUNCTIONS]=["FUNCTION_NAME","PARAMETER_LIST"];
b.Rowset.KEYS[b.MDSCHEMA_HIERARCHIES]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","DIMENSION_UNIQUE_NAME","HIERARCHY_UNIQUE_NAME"];b.Rowset.KEYS[b.MDSCHEMA_LEVELS]="CATALOG_NAME SCHEMA_NAME CUBE_NAME DIMENSION_UNIQUE_NAME HIERARCHY_UNIQUE_NAME LEVEL_UNIQUE_NAME".split(" ");b.Rowset.KEYS[b.MDSCHEMA_MEASURES]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","MEASURE_NAME"];b.Rowset.KEYS[b.MDSCHEMA_MEMBERS]="CATALOG_NAME SCHEMA_NAME CUBE_NAME DIMENSION_UNIQUE_NAME HIERARCHY_UNIQUE_NAME LEVEL_UNIQUE_NAME MEMBER_UNIQUE_NAME".split(" ");
b.Rowset.KEYS[b.MDSCHEMA_PROPERTIES]="CATALOG_NAME SCHEMA_NAME CUBE_NAME DIMENSION_UNIQUE_NAME HIERARCHY_UNIQUE_NAME LEVEL_UNIQUE_NAME MEMBER_UNIQUE_NAME PROPERTY_NAME".split(" ");b.Rowset.KEYS[b.MDSCHEMA_SETS]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","SET_NAME"];M.jsType="boolean";q.jsType="number";D.jsType="number";E.jsType="string";N.jsType="object";O.jsType="object";K.jsType="object";var A={"xsd:boolean":M,"xsd:decimal":D,"xsd:double":D,"xsd:float":D,"xsd:int":q,"xsd:integer":q,"xsd:nonPositiveInteger":q,
"xsd:negativeInteger":q,"xsd:nonNegativeInteger":q,"xsd:positiveInteger":q,"xsd:short":q,"xsd:byte":q,"xsd:long":q,"xsd:unsignedLong":q,"xsd:unsignedInt":q,"xsd:unsignedShort":q,"xsd:unsignedByte":q,"xsd:string":E,"xsd:dateTime":N,Restrictions:O};b.Rowset.prototype={_node:null,_type:null,_row:null,_rows:null,numRows:null,fieldOrder:null,fields:null,_fieldCount:null,_initData:function(){this.numRows=(this._rows=k(this._node,"urn:schemas-microsoft-com:xml-analysis:rowset",null,"row"))?this._rows.length:
0;this.reset();this.fieldOrder=[];this.fields={};this._fieldCount=0;var a=J(this._node,"row");if(a){var c=(a=k(a,"http://www.w3.org/2001/XMLSchema","xsd","sequence")[0].childNodes)?a.length:0,d=this._xmla.options.addFieldGetters,f;for(f=0;f<c;f++){var e=a[f];if(1===e.nodeType){var g=B(e,"urn:schemas-microsoft-com:xml-sql","sql","field");var l=t(e,"name");var n=t(e,"type");if(null===n&&this._row){var h=R(this._row,l);h.length&&(n=B(h[0],"http://www.w3.org/2001/XMLSchema-instance","xsi","type"))}n||
this._type!=b.DISCOVER_SCHEMA_ROWSETS||"Restrictions"!==l||(n="Restrictions");h=(h=t(e,"minOccurs"))?parseInt(h,10):1;(e=t(e,"maxOccurs"))?"unbounded"===e?e=Infinity:h=parseInt(e,10):e=1;var m=P(n);var r=this._createFieldGetter(l,m,h,e);d&&(this[T(l)]=r);this.fields[g]={name:l,label:g,index:this._fieldCount++,type:n,jsType:m.jsType,minOccurs:h,maxOccurs:e,getter:r};this.fieldOrder.push(g)}}}else b.Exception._newError("ERROR_PARSING_RESPONSE","Xmla.Rowset",this._node)._throw()},_createFieldGetter:function(a,
b,d,f){var c;1===f?1===d?c=function(){var c=k(this._row,"urn:schemas-microsoft-com:xml-analysis:rowset",null,a);if(c.length)return b(v(c[0]));m(console.error)||console.error('Field "'+a+"\" is supposed to be present in the rowset but isn't. Are you running on SAP / HANA?");return null}:0===d&&(c=function(){var c=k(this._row,"urn:schemas-microsoft-com:xml-analysis:rowset",null,a);return c.length?b(v(c[0])):null}):1===d?c=function(){var c=k(this._row,"urn:schemas-microsoft-com:xml-analysis:rowset",
null,a);return K(c,b)}:0===d&&(c=function(){var c=k(this._row,"urn:schemas-microsoft-com:xml-analysis:rowset",null,a);return c.length?K(c,b):null});return c},getType:function(){return this._type},getFields:function(){var a=[],b,d=this._fieldCount,f=this.fieldOrder;for(b=0;b<d;b++)a[b]=this.fieldDef(f[b]);return a},getFieldNames:function(){var a=[],b,d=this._fieldCount;for(b=0;b<d;b++)a[b]=this.fieldOrder[b];return a},hasMoreRows:function(){return this.numRows>this.rowIndex},nextRow:function(){this.rowIndex++;
this._row=this._rows[this.rowIndex];return this.rowIndex},next:function(){return this.nextRow()},eachRow:function(a,b,d){m(b)&&(b=this);var c=[null];m(d)||(u(d)||(d=[d]),c=c.concat(d));for(;this.hasMoreRows();){c[0]=this.readAsObject();if(!1===a.apply(b,c))return!1;this.nextRow()}return!0},currRow:function(){return this.rowIndex},rowCount:function(){return this.numRows},reset:function(){this.rowIndex=0;this._row=this.hasMoreRows()?this._rows[this.rowIndex]:null},fieldDef:function(a){var c=this.fields[a];
c||b.Exception._newError("INVALID_FIELD","Xmla.Rowset.fieldDef",a)._throw();return c},fieldIndex:function(a){return this.fieldDef(a).index},fieldName:function(a){var c=this.fieldOrder[a];c||b.Exception._newError("INVALID_FIELD","Xmla.Rowset.fieldDef",a)._throw();return c},fieldVal:function(a){"number"===typeof a&&(a=this.fieldName(a));return this.fieldDef(a).getter.call(this)},fieldCount:function(){return this._fieldCount},close:function(){this._rows=this._row=this._node=null},readAsArray:function(a){var b=
this.fields,d;a||(a=[]);for(d in b)if(b.hasOwnProperty(d)){var f=b[d];a[f.index]=f.getter.call(this)}return a},fetchAsArray:function(a){this.hasMoreRows()?(a=this.readAsArray(a),this.nextRow()):a=!1;return a},readAsObject:function(a){var b=this.fields,d;a||(a={});for(d in b)if(b.hasOwnProperty(d)){var f=b[d];a[d]=f.getter.call(this)}return a},fetchAsObject:function(a){this.hasMoreRows()?(a=this.readAsObject(a),this.nextRow()):a=!1;return a},fetchCustom:function(a,b){this.hasMoreRows()?(a=a.call(this,
b),this.nextRow()):a=!1;return a},fetchAllAsArray:function(a){var b;for(a||(a=[]);b=this.fetchAsArray();)a.push(b);return a},fetchAllAsObject:function(a){var b;for(a||(a=[]);b=this.fetchAsObject();)a.push(b);return a},fetchAllCustom:function(a,b,d){var c;for(a||(a=[]);c=this.fetchCustom(b,d);)a.push(c);return a},mapAsObject:function(a,b,d){var c,e=b.length,g=e-1,l=a;for(a=0;a<e;a++){var h=b[a];h=d[h];(c=l[h])?a===g?u(c)?c.push(d):l[h]=[c,d]:l=c:a===g?l[h]=d:l=l[h]={}}},mapAllAsObject:function(a,b){b||
(b={});a||(a=this.getKey());for(var c;c=this.fetchAsObject();)this.mapAsObject(b,a,c);return b},getKey:function(){return this._type?b.Rowset.KEYS[this._type]:this.getFieldNames()}};b.Dataset=function(a){"string"===typeof a&&(a=I(a));this._initDataset(a);return this};b.Dataset.AXIS_COLUMNS=0;b.Dataset.AXIS_ROWS=1;b.Dataset.AXIS_PAGES=2;b.Dataset.AXIS_SECTIONS=3;b.Dataset.AXIS_CHAPTERS=4;b.Dataset.AXIS_SLICER="SlicerAxis";b.Dataset.prototype={_root:null,_axes:null,_axesOrder:null,_numAxes:null,_slicer:null,
_cellset:null,_initDataset:function(a){this._initRoot(a);this.cubeName=v(k(this._root,"urn:schemas-microsoft-com:xml-analysis:mddataset","","CubeName")[0]);this._initAxes();this._initCells()},_initRoot:function(a){var c=k(a,"urn:schemas-microsoft-com:xml-analysis:mddataset","","root");c.length?this._root=c[0]:b.Exception._newError("ERROR_PARSING_RESPONSE","Xmla.Dataset._initData",a)._throw()},_initAxes:function(){var a,c={};this._axes={};this._axesOrder=[];var d=k(this._root,"urn:schemas-microsoft-com:xml-analysis:mddataset",
"","AxisInfo");var f=d.length;for(a=0;a<f;a++){var e=d[a];var g=t(e,"name");c[g]=e}d=k(this._root,"urn:schemas-microsoft-com:xml-analysis:mddataset","","Axis");f=d.length;for(a=0;a<f;a++)e=d[a],g=t(e,"name"),e=new b.Dataset.Axis(this,c[g],e,g,a),g===b.Dataset.AXIS_SLICER?this._slicer=e:(this._axes[g]=e,this._axesOrder.push(e));this._numAxes=this._axesOrder.length},_initCells:function(){this._cellset=new b.Dataset.Cellset(this)},axisCount:function(){return this._numAxes},_getAxis:function(a){switch(typeof a){case "number":var c=
this._axesOrder[a];break;case "string":c=void 0===b.Dataset.AXIS_SLICER?this._slicer:this._axes[void 0]}return c},getAxis:function(a){if(a===b.Dataset.AXIS_SLICER)return this._slicer;var c=this._getAxis(a);c||b.Exception._newError("INVALID_AXIS","Xmla.Dataset.getAxis",a)._throw();return c},hasAxis:function(a){a=this._getAxis(a);return!m(a)},getColumnAxis:function(){return this.getAxis(b.Dataset.AXIS_COLUMNS)},hasColumnAxis:function(){return this.hasAxis(b.Dataset.AXIS_COLUMNS)},getRowAxis:function(){return this.getAxis(b.Dataset.AXIS_ROWS)},
hasRowAxis:function(){return this.hasAxis(b.Dataset.AXIS_ROWS)},getPageAxis:function(){return this.getAxis(b.Dataset.AXIS_PAGES)},hasPageAxis:function(){return this.hasAxis(b.Dataset.AXIS_PAGES)},getChapterAxis:function(){return this.getAxis(b.Dataset.AXIS_CHAPTERS)},hasChapterAxis:function(){return this.hasAxis(b.Dataset.AXIS_CHAPTERS)},getSectionAxis:function(){return this.getAxis(b.Dataset.AXIS_SECTIONS)},hasSectionAxis:function(){return this.hasAxis(b.Dataset.AXIS_SECTIONS)},getSlicerAxis:function(){return this._slicer},
hasSlicerAxis:function(){return null!==this._slicer},getCellset:function(){return this._cellset},cellOrdinalForTupleIndexes:function(){var a=this._numAxes,b=this._axesOrder,d=0,f;var e=0;for(--a;0<=a;a--,e++){var g=arguments[e];var l=1;for(f=a-1;0<=f;f--)l*=b[f].tupleCount();d+=g*l}return d},fetchAsObject:function(a){var b=function(a){a.getHierarchies();var b=[],c,d=a.numHierarchies;for(c=0;c<d;c++)b.push(a.hierarchy(c));return b},d=[];var f=[];var e=[],g,l=1,h=0;var k=0;for(g=this.axisCount();k<
g;k++)f=this.getAxis(k),l*=f.tupleCount(),d.push({positions:f.fetchAllAsObject(),hierarchies:b(f)});this.hasSlicerAxis()?(f=this.getSlicerAxis(),b={positions:f.fetchAllAsObject(),hierarchies:b(f)}):b={positions:{},hierarchies:[]};f=this.getCellset();if(!0===a)e=f.fetchAllAsObject();else for(k=0,g=l;k<g;k++){a=f.readCell();if(h===a.ordinal){if(e.push(a),-1===f.nextCell())break}else e.push({Value:null,FmtValue:null,FormatString:null,ordinal:h});h++}f.reset();return{cubeName:this.cubeName,axes:d,filterAxis:b,
cells:e}},reset:function(){this._cellset&&this._cellset.reset();if(this._axes){var a;var b=0;for(a=this.axisCount();b<a;b++)this.getAxis(b).reset()}},close:function(){this._slicer&&this._slicer.close();var a,b=this._numAxes;for(a=0;a<b;a++)this.getAxis(a).close();this._cellset.close();this._slicer=this._numAxes=this._axesOrder=this._axes=this._root=this._cellset=null}};b.Dataset.Axis=function(a,b,d,f,e){this._dataset=a;this._initAxis(b,d);this.name=f;this.id=e;return this};b.Dataset.Axis.MEMBER_UNIQUE_NAME=
"UName";b.Dataset.Axis.MEMBER_CAPTION="Caption";b.Dataset.Axis.MEMBER_LEVEL_NAME="LName";b.Dataset.Axis.MEMBER_LEVEL_NUMBER="LNum";b.Dataset.Axis.MEMBER_DISPLAY_INFO="DisplayInfo";b.Dataset.Axis.DefaultMemberProperties=[b.Dataset.Axis.MEMBER_UNIQUE_NAME,b.Dataset.Axis.MEMBER_CAPTION,b.Dataset.Axis.MEMBER_LEVEL_NAME,b.Dataset.Axis.MEMBER_LEVEL_NUMBER,b.Dataset.Axis.MEMBER_DISPLAY_INFO];b.Dataset.Axis.MDDISPINFO_CHILDREN_CARDINALITY=65535;b.Dataset.Axis.MDDISPINFO_DRILLED_DOWN=65536;b.Dataset.Axis.MDDISPINFO_SAME_PARENT_AS_PREV=
131072;b.Dataset.Axis.prototype={id:-1,name:null,_dataset:null,_tuples:null,_members:null,_memberProperties:null,numTuples:null,numHierarchies:null,_tupleIndex:null,_hierarchyIndex:null,_hierarchyOrder:null,_hierarchyDefs:null,_hierarchyIndexes:null,_initHierarchies:function(a){a=k(a,"urn:schemas-microsoft-com:xml-analysis:mddataset","","HierarchyInfo");var c=a.length,d,f,e,g=this._memberProperties;this._hierarchyDefs={};this._hierarchyOrder=[];this._hierarchyIndexes={};this.numHierarchies=c;for(d=
0;d<c;d++){var h=a[d];var n=t(h,"name");this._hierarchyOrder[d]=n;this._hierarchyIndexes[n]=d;var m={index:d,name:n,properties:f={}};var u=k(h,"urn:schemas-microsoft-com:xml-analysis:mddataset","","*");var r=u.length;for(h=0;h<r;h++){var p=u[h];var q=p.nodeName;var v=t(p,"type");if(!v)if(e=g[q])v=e.type;else switch(q){case b.Dataset.Axis.MEMBER_LEVEL_NUMBER:case b.Dataset.Axis.MEMBER_DISPLAY_INFO:v="xsd:int"}(v=A[v])||(v=E);e=L(q);switch(e){case b.Dataset.Axis.MEMBER_UNIQUE_NAME:case b.Dataset.Axis.MEMBER_CAPTION:case b.Dataset.Axis.MEMBER_LEVEL_NAME:case b.Dataset.Axis.MEMBER_LEVEL_NUMBER:case b.Dataset.Axis.MEMBER_DISPLAY_INFO:p=
e;break;default:if(p=t(p,"name"))p=p.split("."),p=p[p.length-1],"["===p.charAt(0)&&"]"===p.charAt(p.length-1)&&(p=p.substr(1,p.length-2))}f[q]={converter:v,name:e,propertyName:p}}this._hierarchyDefs[n]=m}},_initMembers:function(){var a=this._dataset._root,c,d,f=this._memberProperties={};(c=J(a,"MemberType"))||b.Exception._newError("ERROR_PARSING_RESPONSE","Xmla.DataSet.Axis",a)._throw();c=k(c,"http://www.w3.org/2001/XMLSchema","xsd","sequence");if(c.length)for(c=c[0],a=k(c,"http://www.w3.org/2001/XMLSchema",
"xsd","element"),c=a.length,d=0;d<c;d++){var e=a[d];var g=t(e,"type");e=t(e,"name");f[e]={type:g,converter:A[g],name:L(e)}}else m(console.error)||console.error("MemberType in schema does not define any child elements. Are you running on Jedox/Palo?")},_initAxis:function(a,b){this.name=t(b,"name");this._initMembers();this._initHierarchies(a);this._tuples=k(b,"urn:schemas-microsoft-com:xml-analysis:mddataset","","Tuple");this.numTuples=this._tuples.length;this.reset()},close:function(){this.numTuples=
-1;this._members=this._hierarchyIndexes=this._hierarchyOrder=this._hierarchyDefs=this._tuples=null},_getMembers:function(){return this.hasMoreTuples()?k(this._tuples[this._tupleIndex],"urn:schemas-microsoft-com:xml-analysis:mddataset","","Member"):null},reset:function(){this._tupleIndex=this._hierarchyIndex=0;this._members=this._getMembers()},hasMoreHierarchies:function(){return this.numHierarchies>this._hierarchyIndex},nextHierarchy:function(){return this._hierarchyIndex++},eachHierarchy:function(a,
b,d){var c=[null];b||(b=this);d&&(u(d)||(d=[d]),c=c.concat(d));for(;this.hasMoreHierarchies();){c[0]=this._hierarchyDefs[this._hierarchyOrder[this._hierarchyIndex]];if(!1===a.apply(b,c))return!1;this.nextHierarchy()}this._hierarchyIndex=0;return!0},hasMoreTuples:function(){return this.numTuples>this._tupleIndex},nextTuple:function(){this._tupleIndex++;this._members=this._getMembers();return this._tupleIndex},tupleCount:function(){return this.numTuples},tupleIndex:function(){return this._tupleIndex},
getTuple:function(){var a,b=this.numHierarchies,d={},f=[],e={index:this._tupleIndex,hierarchies:d,members:f};for(a=0;a<b;a++){var g=this._member(a);d[this._hierarchyOrder[a]]=g;f.push(g)}return e},eachTuple:function(a,b,d){var c=[null];b||(b=this);for(d&&(u(d)?c.concat(d):c.push(d));this.hasMoreTuples();){c[0]=this.getTuple();if(!1===a.apply(b,c))return!1;this.nextTuple()}this._tupleIndex=0;this._members=this._getMembers();return!0},getHierarchies:function(){return this._hierarchyDefs},getHierarchyNames:function(){var a=
[],b,d=this.numHierarchies;for(b=0;b<d;b++)a[b]=this._hierarchyOrder[b];return a},hierarchyCount:function(){return this.numHierarchies},hierarchyIndex:function(a){if(m(a))return this._hierarchyIndex;var c=this._hierarchyIndexes[a];m(c)&&b.Exception._newError("INVALID_HIERARCHY","Xmla.Dataset.Axis.hierarchyDef",a)._throw();return c},hierarchyName:function(a){m(a)&&(a=this._hierarchyIndex);(a!==parseInt(a,10)||a>=this.numHierarchies)&&b.Exception._newError("INVALID_HIERARCHY","Xmla.Dataset.Axis.hierarchyDef",
a)._throw();return this._hierarchyOrder[a]},hierarchy:function(a){m(a);"number"===typeof a&&((a!==parseInt(a,10)||a>=this.numHierarchies)&&b.Exception._newError("INVALID_HIERARCHY","Xmla.Dataset.Axis.hierarchyDef",a)._throw(),a=this.hierarchyName(a));var c=this._hierarchyDefs[a];m(c)&&b.Exception._newError("INVALID_HIERARCHY","Xmla.Dataset.Axis.hierarchyDef",a)._throw();return c},member:function(a){if(m(a))var c=this._hierarchyIndex;switch(typeof a){case "string":c=this.hierarchyIndex(a);break;case "number":(a!==
parseInt(a,10)||a>=this.numHierarchies)&&b.Exception._newError("INVALID_HIERARCHY","Xmla.Dataset.Axis.hierarchyDef",a)._throw(),c=a}return this._member(c)},_member:function(a){var b=this._members[a].childNodes,d=b.length,f=this.hierarchyName(a),e=this._hierarchyDefs[f].properties,g={index:a,hierarchy:f};for(a=0;a<d;a++){var h=b[a];1===h.nodeType&&(f=e[h.nodeName])&&(g[f.propertyName||f.name]=f.converter(v(h)))}return g},hasMemberProperty:function(a){return!m(this._memberProperties[a])},readAsArray:function(a){a||
(a=[]);var b,d=this.numHierarchies;for(b=0;b<d;b++)a[b]=this._member(b);return a},readAsObject:function(a){a||(a={});var b,d=this.numHierarchies;for(b=0;b<d;b++)a[this._hierarchyOrder[b]]=this._member(b);return a},fetchAsArray:function(a){this.hasMoreTuples()?(a=this.readAsArray(a),this.nextTuple()):a=!1;return a},fetchAsObject:function(a){this.hasMoreTuples(a)?(a=this.readAsObject(),this.nextTuple()):a=!1;return a},fetchAllAsArray:function(a){var b;for(a||(a=[]);b=this.fetchAsArray();)a.push(b);
this.reset();return a},fetchAllAsObject:function(a){var b;for(a||(a=[]);b=this.fetchAsObject();)a.push(b);this.reset();return a}};b.Dataset.Cellset=function(a){this._dataset=a;this._initCellset();return this};b.Dataset.Cellset.prototype={_dataset:null,_cellNodes:null,_cellCount:null,_cellNode:null,_cellProperties:null,_idx:null,_cellOrd:null,_initCellset:function(){var a=this._dataset._root,c,d,f,e;(c=J(a,"CellData"))||b.Exception._newError("ERROR_PARSING_RESPONSE","Xmla.Dataset.Cellset",a)._throw();
c=k(c,"http://www.w3.org/2001/XMLSchema","xsd","element");var g=c.length;(d=k(a,"urn:schemas-microsoft-com:xml-analysis:mddataset","","CellInfo"))&&0!==d.length||b.Exception._newError("ERROR_PARSING_RESPONSE","Xmla.Rowset",a)._throw();d=k(d[0],"urn:schemas-microsoft-com:xml-analysis:mddataset","","*");this._cellProperties={};var h=d.length;var n=this,m=function(a){n["cell"+a]=function(){return this.cellProperty(a)}};for(f=0;f<h;f++){var q=d[f];var r=q.nodeName;for(e=0;e<g;e++){var p=c[e];if(t(p,"name")===
r){p=t(p,"type");this._cellProperties[r]=A[p];m(r);break}}this._cellProperties[r]||((p=t(q,"type"))||(p="Value"===r?"xs:decimal":"xs:string"),this._cellProperties[r]=A[p],m(r))}this._cellNodes=k(a,"urn:schemas-microsoft-com:xml-analysis:mddataset","","Cell");this._cellCount=this._cellNodes.length;this.reset()},_getCellNode:function(a){m(a)||(this._idx=a);this._cellNode=this._cellNodes[this._idx];this._cellOrd=this._getCellOrdinal(this._cellNode)},_getCellOrdinal:function(a){return parseInt(t(a,"CellOrdinal"),
10)},cellCount:function(){return this._cellNodes.length},reset:function(a){this._idx=a?a:0;this.hasMoreCells()&&this._getCellNode()},hasMoreCells:function(){return this._idx<this._cellCount},nextCell:function(){this._idx+=1;if(this.hasMoreCells())return this._getCellNode(),this._cellOrd;this._idx=0;return-1},curr:function(){return this._idx},hasCellProperty:function(a){return!m(this._cellProperties[a])},cellProperty:function(a){var b=k(this._cellNode,"urn:schemas-microsoft-com:xml-analysis:mddataset",
"",a);if(b.length){b=b[0];var d=Q(b);a=this._cellProperties[a];a||(b=B(b,"http://www.w3.org/2001/XMLSchema-instance","xsi","type"),a=P(b));d=a(d)}else d=null;return d},cellOrdinal:function(){return this._cellOrd},_readCell:function(a,b){var c,f;for(c in this._cellProperties)if(f=k(a,"urn:schemas-microsoft-com:xml-analysis:mddataset","",c)[0]){var e=this._cellProperties[c];b[c]=e?e(v(f)):"Value"===c?Q(f):v(f)}b.ordinal=this._getCellOrdinal(a);return b},readCell:function(a){a||(a={});return this._readCell(this._cellNode,
a)},eachCell:function(a,b,d){var c=[null];b||(b=this);d&&(u(d)||(d=[d]),c=c.concat(d));for(var e;-1!==e&&this.hasMoreCells();)if(e=this.nextCell(),c[0]=this.readCell(),!1===a.apply(b,c))return!1;this._idx=0;return!0},fetchAllAsObject:function(){var a={},b,d=this._cellCount;for(b=0;b<d;b++){var f=this.readCell();a[f.ordinal]=f;this.nextCell()}return a},getByIndex:function(a,b){this._getCellNode(a);return this.readCell(b)},getByOrdinal:function(a,b){var c=this.cellCount()-1;for(c=a>c?c:a;;){var f=this._cellNodes[c];
f=this._getCellOrdinal(f);if(f===a)return this.getByIndex(c,b);if(f>a)c--;else return null}},indexForOrdinal:function(a){for(var b=this._cellNodes,d=Math.min(a,b.length-1),f;0<=d;){f=b[d];f=this._getCellOrdinal(f);if(f===a)return d;if(f>a)d--;else break}return-1},fetchRangeAsArray:function(a,b){var c=[],f=this._cellNodes,e=f.length;if(0===e)return c;if(m(b)||-1===b)b=this._getCellOrdinal(f[e-1]);if(m(a)||-1===a)a=this._getCellOrdinal(f[0]);for(e=Math.min(b,e-1);0<=e;){var g=f[e];g=this._getCellOrdinal(g);
if(g<=b)break;--e}if(-1===e||g<a)return c;for(b=Math.min(e,a);0<=b;){g=f[b];g=this._getCellOrdinal(g);if(g<=a){g<a&&(b+=1);break}--b}-1===b&&(b=0);for(a=b;a<=e;a++)g=f[a],c.push(this._readCell(g,{}));return c},cellOrdinalForTupleIndexes:function(){return this._dataset.cellOrdinalForTupleIndexes.apply(this._dataset,arguments)},getByTupleIndexes:function(){return this.getByOrdinal(this.cellOrdinalForTupleIndexes.apply(this,arguments))},close:function(){this._cellNode=this._cellNodes=this._dataset=null}};
b.Exception=function(a,b,d,f,e,g,h,k,m){this.type=a;this.code=b;this.message=d;this.source=e;this.helpfile=f;this.data=g;this.args=h;this.detail=k;this.actor=m;return this};b.Exception.TYPE_WARNING="warning";b.Exception.TYPE_ERROR="error";b.Exception.MISSING_REQUEST_TYPE_CDE=-1;b.Exception.MISSING_REQUEST_TYPE_MSG="Missing_Request_Type";b.Exception.MISSING_REQUEST_TYPE_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.MISSING_REQUEST_TYPE_CDE+"_"+b.Exception.MISSING_REQUEST_TYPE_MSG;
b.Exception.MISSING_STATEMENT_CDE=-2;b.Exception.MISSING_STATEMENT_MSG="Missing_Statement";b.Exception.MISSING_STATEMENT_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.MISSING_STATEMENT_CDE+"_"+b.Exception.MISSING_STATEMENT_MSG;b.Exception.MISSING_URL_CDE=-3;b.Exception.MISSING_URL_MSG="Missing_URL";b.Exception.MISSING_URL_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.MISSING_URL_CDE+"_"+b.Exception.MISSING_URL_MSG;b.Exception.NO_EVENTS_SPECIFIED_CDE=
-4;b.Exception.NO_EVENTS_SPECIFIED_MSG="No_Events_Specified";b.Exception.NO_EVENTS_SPECIFIED_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.NO_EVENTS_SPECIFIED_CDE+"_"+b.Exception.NO_EVENTS_SPECIFIED_MSG;b.Exception.WRONG_EVENTS_FORMAT_CDE=-5;b.Exception.WRONG_EVENTS_FORMAT_MSG="Wrong_Events_Format";b.Exception.WRONG_EVENTS_FORMAT_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.NO_EVENTS_SPECIFIED_CDE+"_"+b.Exception.NO_EVENTS_SPECIFIED_MSG;b.Exception.UNKNOWN_EVENT_CDE=
-6;b.Exception.UNKNOWN_EVENT_MSG="Unknown_Event";b.Exception.UNKNOWN_EVENT_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.UNKNOWN_EVENT_CDE+"_"+b.Exception.UNKNOWN_EVENT_MSG;b.Exception.INVALID_EVENT_HANDLER_CDE=-7;b.Exception.INVALID_EVENT_HANDLER_MSG="Invalid_Events_Handler";b.Exception.INVALID_EVENT_HANDLER_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.INVALID_EVENT_HANDLER_CDE+"_"+b.Exception.INVALID_EVENT_HANDLER_MSG;b.Exception.ERROR_PARSING_RESPONSE_CDE=
-8;b.Exception.ERROR_PARSING_RESPONSE_MSG="Error_Parsing_Response";b.Exception.ERROR_PARSING_RESPONSE_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.ERROR_PARSING_RESPONSE_CDE+"_"+b.Exception.ERROR_PARSING_RESPONSE_MSG;b.Exception.INVALID_FIELD_CDE=-9;b.Exception.INVALID_FIELD_MSG="Invalid_Field";b.Exception.INVALID_FIELD_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.INVALID_FIELD_CDE+"_"+b.Exception.INVALID_FIELD_MSG;b.Exception.HTTP_ERROR_CDE=-10;
b.Exception.HTTP_ERROR_MSG="HTTP Error";b.Exception.HTTP_ERROR_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.HTTP_ERROR_CDE+"_"+b.Exception.HTTP_ERROR_MSG;b.Exception.INVALID_HIERARCHY_CDE=-11;b.Exception.INVALID_HIERARCHY_MSG="Invalid_Hierarchy";b.Exception.INVALID_HIERARCHY_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.INVALID_HIERARCHY_CDE+"_"+b.Exception.INVALID_HIERARCHY_MSG;b.Exception.UNEXPECTED_ERROR_READING_MEMBER_CDE=-12;b.Exception.UNEXPECTED_ERROR_READING_MEMBER_MSG=
"Error_Reading_Member";b.Exception.UNEXPECTED_ERROR_READING_MEMBER_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.UNEXPECTED_ERROR_READING_MEMBER_CDE+"_"+b.Exception.UNEXPECTED_ERROR_READING_MEMBER_MSG;b.Exception.INVALID_AXIS_CDE=-13;b.Exception.INVALID_AXIS_MSG="The requested axis does not exist.";b.Exception.INVALID_AXIS_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.INVALID_AXIS_CDE+"_"+b.Exception.INVALID_AXIS_MSG;b.Exception.ILLEGAL_ARGUMENT_CDE=
-14;b.Exception.ILLEGAL_ARGUMENT_MSG="Illegal arguments";b.Exception.ILLEGAL_ARGUMENT_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.ILLEGAL_ARGUMENT_CDE+"_"+b.Exception.ILLEGAL_ARGUMENT_MSG;b.Exception.ERROR_INSTANTIATING_XMLHTTPREQUEST_CDE=-15;b.Exception.ERROR_INSTANTIATING_XMLHTTPREQUEST_MSG="Error creating XML Http Request";b.Exception.ERROR_INSTANTIATING_XMLHTTPREQUEST_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.ERROR_INSTANTIATING_XMLHTTPREQUEST_CDE+
"_"+b.Exception.ERROR_INSTANTIATING_XMLHTTPREQUEST_MSG;b.Exception._newError=function(a,c,d){return new b.Exception(b.Exception.TYPE_ERROR,b.Exception[a+"_CDE"],b.Exception[a+"_MSG"],b.Exception[a+"_HLP"],c,d)};b.Exception.prototype={type:null,code:null,message:null,source:null,helpfile:null,data:null,_throw:function(){throw this;},args:null,toString:function(){return this.type+" "+this.code+": "+this.message+" (source: "+this.source+",  actor: "+this.actor+")"},getStackTrace:function(){if(this.args)for(var a=
this.args.callee;a;)a=a.caller;return""}};"function"===typeof define&&define.amd?define(function(){return b}):z.Xmla=b;return b})("undefined"===typeof exports?window:exports);
